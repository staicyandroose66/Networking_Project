<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="assets/css/index.css">
    <link rel="stylesheet" href="assets/css/index-images.css">
    <!-- Navik navigation CSS -->
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <!-- Google fonts -->

    <title>NavBar</title>
    <style>
        .icon-badge {
            background-color: red;
            font-size: 12px;
            color: white;
            text-align: center;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: absolute;
            top: -14px;
            left: 19%;
        }
    </style>
</head>

<body>

    <!-- Header -->
    <div class="navik-header header-shadow">
        <div class="container">

            <!-- Navik header -->
            <div class="navik-header-container">

                <!--Logo-->
                <div class="logo" data-mobile-logo="assets/images/gym-icon.png" data-sticky-logo="assets/images/gym-icon.png">
                    <a href="#"><img src="assets/images/gym-icon.png" alt="logo" /></a>
                </div>

                <!-- Burger menu -->
                <div class="burger-menu">
                    <div class="line-menu line-half first-line"></div>
                    <div class="line-menu"></div>
                    <div class="line-menu line-half last-line"></div>
                </div>

                <!--Navigation menu-->
                <nav class="navik-menu menu-caret submenu-top-border submenu-scale">
                    <ul class="list-unstyled">
                       <!--  <li>
                                <input type="text" name="item-1-quantity" class="search-bar" placeholder="search the product.." value="" >
                           
                        </li> -->
                        <li>
                            <a href="index.html"> <i class="fas fa-home"></i> Home</a>
                        </li>
                        <!-- <li><a href="#">Services</a></li>
                    <li><a href="#">Portfolio</a></li> -->
                        <li class="current-menu"><a href="cart.html"><i class="fa fa-shopping-cart">
                                    <div class="icon-badge">0</div>
                                </i> Cart</a></li>
                        <li id="logged-in-info" class="submenu-right">
                            <a href="#" id="username"> </a>
                            <ul class="list-unstyled">
                                <li><a href="login.html">Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </nav>

            </div>


        </div>
    </div>

<!-- video-->
<div >
    <div class="video-section">
        <video class="video-banner" autoplay muted loop id="myVideo">
           <source src="assets/images/video-banner.mp4" type="video/mp4">
         </video> 
         <div class="overlay">
           <h1 style="color:white;">IRELAND'S<span style="color: green; font-weight: 500;"> &nbsp;  EXERCISE &nbsp; EQUIPMENT</span>&nbsp; STORE</h1>
           
               <input type="text" name="item-1-quantity" class="search-bar" placeholder="Search your product.." value="">
               <input type="text" name="item-1-quantity" class="search-bar-mobile search-bar" placeholder="Search.. " value="">
           
       </div>
   </div>
</div>
    <div class="listing-section">



    </div>


    <!-- modal to show when the user is ont logged in  -->
    <div id="login-confirmation" class="modal" tabindex="-1" style="margin-top: 8%;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" style="width: 90%;">Alert</h5>
                    <button type="button" class="close login-confirmation-close" data-dismiss="modal" aria-label="Close" style="text-align: right;"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body">
                    <p>To add an item to the cart you have to login first.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary login-confirmation-close">Close</button>
                    <button id="login-confirmation-login" type="button" class="btn btn-primary">Login</button>
                </div>
            </div>
        </div>
    </div>
    <!-- modal to show normal messages -->
    <div id="message-modal" class="modal" tabindex="-1" style="margin-top: 8%;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" style="width: 90%;">Alert</h5>
                    <button type="button" class="close message-modal-close" data-dismiss="modal" aria-label="Close" style="text-align: right;"><span aria-hidden="true">&times;</span></button>
                </div>
                <div class="modal-body">
                    <!-- <p>To add an item to the cart you have to login first.</p> -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary message-modal-close">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- product modal -->
    <div id="product-modal" class="modal" tabindex="-1" style="margin-top: 8%;overflow: scroll;">
        <div class="modal-dialog  modal-lg">
            <div class="modal-content">
                <!-- <div class="modal-header">
                        <h5 class="modal-title" style="width: 90%;">Alert</h5>
                        <button type="button" class="close message-modal-close" data-dismiss="modal" aria-label="Close" style="text-align: right;"><span aria-hidden="true">&times;</span></button>
                    </div> -->
                <div class="modal-body">
                    <!-- <p>To add an item to the cart you have to login first.</p> -->
                    <div class="row">
                        <div class="col-md-6">
                            <img class="product-modal-image" src="" style="width: 100%;" />
                        </div>
                        <div class="col-md-6">
                            <h4 class="pro-d-title"> <a href="#" class="">  </a></h4>
                            <p class="product-description"> Praesent ac condimentum felis. Nulla at nisl orci, at dignissim dolor, The best product descriptions address your ideal buyer directly and personally. The best product descriptions address your ideal buyer directly and personally.</p>
                            <div class="product_meta">
                                <span class="posted_in"> <strong>Category:</strong> 
                                    <a rel="tag" href="#"></a>
                            </div>
                            <div class="m-bot15">
                                <strong>Price : </strong> <span class="pro-price"> $300.00</span>
                            </div>
                            <div class="row">
                                <div class="col-md-3"><span for="item-1-quantity"><strong>Quantity:</strong></span></div>
                                <div class="col-md-9"><input type="number" name="item-1-quantity" class="quantity" value="1"></div>


                            </div>
                            <p> <button class="btn btn-round btn-danger add-to-cart-modal" type="button"><i class="fa fa-shopping-cart"></i> Add to Cart</button></p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn  product-modal-close" style="background-color: grey;">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        var _selectedList = [];
        $(document).ready(function() {

            if (!IsUserLoggedIn()) {
                $('#logged-in-info').hide();
                $('.icon-badge').hide();

            } else {
                var username = localStorage.getItem('_username');

                if (username == null || username == "") {
                    username = 'User';
                }
                var fullUsername = '<i class="fa fa-user"></i> ' + username
                $('#username').html(fullUsername)
                $('#logged-in-info').show();
                notificationBadgeCounter();
                $('.icon-badge').show();
            }
            $('.login-confirmation-close').on('click', function() {
                $('#login-confirmation').hide();
            })
            $('#login-confirmation-login').on('click', function() {
                window.location.replace("login.html");
            })
            $('.message-modal-close').on('click', function() {
                $('#message-modal').hide();
            })

            $('.product-modal-close').on('click', function() {
                $('#product-modal').hide();
            })



            $('.search-bar').on('keyup keydown', function() {
                populateProducts($(this).val())
            })
            $(document).on('click', '.add-to-cart,.add-to-cart-modal', function() {
                if (!IsUserLoggedIn()) {
                    $('#login-confirmation').show();
                    return;
                }

                _selectedList = JSON.parse(localStorage.getItem('_selectedList'));
                if (_selectedList == null)
                    _selectedList = [];

                var pid = $(this).attr('p-id');
                var quantity = $(this).siblings('.quantity').val();
                if (quantity == null || quantity == undefined) {
                    quantity = $('#product-modal').find('.quantity').val();
                }

                $.getJSON('assets/json/product.json', function(productList) {
                    var new_arr = $.grep(productList, function(n, i) { // just use arr
                        return n.ID == pid;
                    });
                    var curr_object = new_arr[0];
                    curr_object.Quanity = quantity;
                    //REMOVED THE CURRENT OBJECT FROM THE LOCAL STORAGE LIST
                    _selectedList = $.grep(_selectedList, function(n, i) { // just use arr
                        return n.ID != curr_object.ID;
                    });

                    _selectedList.push(curr_object);

                    localStorage.setItem('_selectedList', JSON.stringify(_selectedList));
                    MessageShow('Info', 'The product has been added to the cart');
                    notificationBadgeCounter();
                    //if from the product modal
                    $('#product-modal').hide();
                    //console.log(new_arr)
                    // alert(pid)

                });




            })
            $(document).on('click', '.product .images', function() {
                if ($(this).hasClass('add-to-cart')) {
                    return;
                }
                // var img = $(this).find('.images').css("background-image")
                var img = $(this).css("background-image")
                img = (img).replace('url("', '').replace('")', '');
                $('.product-modal-image').attr('src', img)
                var pid = $(this).find('.add-to-cart').attr("p-id")
                $('.add-to-cart-modal').attr('p-id', pid)

                $.getJSON('assets/json/product.json', function(productList) {
                    var new_arr = $.grep(productList, function(n, i) { // just use arr
                        return n.ID == pid;
                    });
                    var curr_object = new_arr[0];
                    $('.pro-d-title a').html(curr_object.Title)
                    $('.product-description').html(curr_object.DescriptionDetail)
                    $('.posted_in a').html(curr_object.Category)
                    $('.pro-price').html(curr_object.Price)


                });

                $('#product-modal').show();
            })

            populateProducts("");

        });

        function populateProducts(searchText) {
            $('.listing-section').empty();
            //var searchText = "small";
            searchText = searchText.toLocaleLowerCase();
            $.getJSON('assets/json/product.json', function(result) {
                $.each(result, function(i, v) {
                    if (v.Title.toLocaleLowerCase().indexOf(searchText) >= 0 || searchText == "") {
                        $('.listing-section').append('<div class="product"> \
                        <div class="image-box"> \
                            <div class="images" style="background-image: url(\'' + v.URL + '\');"></div> \
                        </div> \
                        <div class="text-box"> \
                            <h2 class="item">' + v.Title + '</h2> \
                            <h3 class="price">$' + v.Price + '</h3> \
                            <label for="item-1-quantity">Quantity:</label> \
                            <input type="number" name="item-1-quantity" class="quantity" value="' + v.Quanity + '"> \
                            <button type="button" name="item-1-button" class="add-to-cart" p-id="' + v.ID + '">Add to Cart</button> \
                        </div> \
                    </div>')

                    }


                });


            });



        }

        function IsUserLoggedIn() {
            var token = localStorage.getItem('_token');
            if (token == null || token == "") {
                return false;
            } else {
                return true;
            }
        }

        function MessageShow(heading, body) {
            $('#message-modal .modal-title').html(heading)
            $('#message-modal .modal-body').html('<p>' + body + '</p>')
            $('#message-modal').show();
        }

        function notificationBadgeCounter() {
            _selectedList = JSON.parse(localStorage.getItem('_selectedList'));
            if (_selectedList == null)
                _selectedList = [];
            var count = _selectedList.length;
            $(".icon-badge").html(count)

        }
        // $('#divID').css("background-image", "url(/myimage.jpg)");
    </script>

    <script src="assets/js/index.js"></script>
    <!-- Navik navigation jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


</body>

</html>